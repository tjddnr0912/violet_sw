# 🚨 실제 거래 설정 가이드 (Version 2)

## ⚠️ 중요 경고

**실제 거래는 실제 자금 손실 위험이 있습니다!**

- 반드시 충분한 백테스팅과 모의 거래 후 진행하세요
- 소액으로 시작하여 점진적으로 확대하세요
- 손실 가능성을 완전히 이해하고 수용할 수 있어야 합니다

---

## 📋 실제 거래 활성화 체크리스트

### ✅ 사전 준비 (필수)

- [ ] 최소 10개월 백테스팅 완료 및 결과 분석
- [ ] Dry-run 모드로 최소 1주일 테스트
- [ ] 전략 로직 완전히 이해
- [ ] 손실 감내 범위 설정 (예: 총 자금의 10%)
- [ ] 비상 연락 체계 구축
- [ ] API 키 발급 및 보안 설정

---

## 🔧 설정 변경 방법

### 1️⃣ config_v2.py 파일 열기

```bash
cd /Users/seongwookjang/project/git/violet_sw/005_money/001_python_code/ver2
nano config_v2.py
# 또는
code config_v2.py
```

### 2️⃣ EXECUTION_CONFIG 수정

**현재 (모의 거래):**
```python
# Execution Mode Configuration
EXECUTION_CONFIG = {
    'mode': 'backtest',  # 'backtest' or 'live'
    'dry_run': True,     # Simulate trades without real execution
    'confirmation_required': True,  # Require confirmation before trades
}
```

**실제 거래로 변경:**
```python
# Execution Mode Configuration
EXECUTION_CONFIG = {
    'mode': 'live',      # ← 'backtest'에서 'live'로 변경
    'dry_run': False,    # ← True에서 False로 변경 ⚠️
    'confirmation_required': True,  # 유지 (안전을 위해)
}
```

### 3️⃣ SAFETY_CONFIG 수정

**현재 (모의 거래):**
```python
# Safety Configuration (for live trading)
SAFETY_CONFIG = {
    'dry_run': True,
    'emergency_stop': False,
    'max_daily_trades': 5,
    'max_consecutive_losses': 3,
    'max_daily_loss_pct': 3.0,
    'require_confirmation': True,
    'balance_check_interval': 60,  # minutes
}
```

**실제 거래로 변경:**
```python
# Safety Configuration (for live trading)
SAFETY_CONFIG = {
    'dry_run': False,                # ← True에서 False로 변경 ⚠️
    'emergency_stop': False,         # 유지 (긴급 시 True로 변경)
    'max_daily_trades': 2,           # ← 처음엔 2로 제한 (보수적)
    'max_consecutive_losses': 2,     # ← 처음엔 2로 제한 (보수적)
    'max_daily_loss_pct': 2.0,       # ← 처음엔 2%로 제한 (보수적)
    'require_confirmation': True,    # 유지 (안전을 위해)
    'balance_check_interval': 30,    # ← 30분으로 더 자주 확인
}
```

### 4️⃣ TRADING_CONFIG 수정

**거래 금액 설정:**
```python
# Trading Configuration (for live trading)
TRADING_CONFIG = {
    'symbol': 'BTC',              # 거래할 코인
    'trade_amount_krw': 10000,    # ← 처음엔 최소 금액 (10,000원)
    'min_trade_amount': 10000,    # 최소 거래 금액
    'trading_fee_rate': 0.0005,   # 빗썸 수수료 0.05%
}
```

**권장 초기 설정:**
- 첫 1주일: `10,000원`
- 2주차: `20,000원`
- 3주차: `30,000원`
- 4주차 이후: 성과에 따라 점진적 증가

### 5️⃣ API_CONFIG 확인

```python
# API Configuration (for live trading)
API_CONFIG = {
    'exchange': 'bithumb',
    'check_interval_seconds': 14400,  # 4시간 (4H 타임프레임)
    'rate_limit_seconds': 1.0,
    'timeout_seconds': 15,
}
```

**설명:**
- `check_interval_seconds: 14400` = 4시간마다 체크 (4H 캔들)
- 더 자주 체크하려면 값 줄이기 (예: 3600 = 1시간)

---

## 🔑 API 키 설정

### 빗썸 API 키 발급

1. 빗썸 로그인
2. 마이페이지 → API 관리
3. API 키 생성
   - **읽기 권한:** ✅ 활성화
   - **거래 권한:** ✅ 활성화
   - **출금 권한:** ❌ 비활성화 (안전)

### 환경 변수 설정 (권장)

```bash
# ~/.bashrc 또는 ~/.zshrc에 추가
export BITHUMB_API_KEY="your_api_key_here"
export BITHUMB_SECRET_KEY="your_secret_key_here"
```

**적용:**
```bash
source ~/.bashrc  # 또는 source ~/.zshrc
```

### 또는 config.py에 직접 추가 (비권장)

```python
# lib/api/bithumb_api.py 또는 config.py에서
API_KEYS = {
    'bithumb': {
        'api_key': 'your_api_key_here',      # ⚠️ 보안 주의
        'secret_key': 'your_secret_key_here',  # ⚠️ 보안 주의
    }
}
```

---

## 🚀 실제 거래 실행

### 단계별 실행

#### 1단계: 설정 확인

```bash
cd /Users/seongwookjang/project/git/violet_sw/005_money/001_python_code/ver2
python3 -c "from config_v2 import EXECUTION_CONFIG, SAFETY_CONFIG, TRADING_CONFIG; \
print('Mode:', EXECUTION_CONFIG['mode']); \
print('Dry-run:', EXECUTION_CONFIG['dry_run']); \
print('Amount:', TRADING_CONFIG['trade_amount_krw'])"
```

**예상 출력 (실제 거래):**
```
Mode: live
Dry-run: False
Amount: 10000
```

#### 2단계: 최종 확인

**⚠️ 다시 한번 확인:**
- [ ] `EXECUTION_CONFIG['dry_run']` = `False`
- [ ] `SAFETY_CONFIG['dry_run']` = `False`
- [ ] API 키가 올바르게 설정됨
- [ ] 거래 금액이 감당 가능한 수준
- [ ] 손실 제한이 설정됨

#### 3단계: 실행

```bash
cd /Users/seongwookjang/project/git/violet_sw/005_money/001_python_code/ver2
python3 main_v2.py --mode live --live
```

**또는 명령행에서 금액 지정:**
```bash
python3 main_v2.py --mode live --live --symbol BTC --amount 10000
```

#### 4단계: 확인 메시지

```
⚠️  경고: 실제 거래 모드를 활성화하려고 합니다!
실제 자금이 사용됩니다. 계속하시겠습니까?

설정 확인:
  거래 코인: BTC
  거래 금액: 10,000 KRW
  일일 거래 한도: 2회
  일일 손실 한도: 2.0%
  연속 손실 한도: 2회

확인하려면 "I UNDERSTAND THE RISKS"를 입력하세요:
```

**정확히 입력:**
```
I UNDERSTAND THE RISKS
```

#### 5단계: 실행 확인

```
✅ 실제 거래 모드 활성화됨
🔄 4시간마다 시장 분석 시작...
📊 다음 체크: 2025-10-03 18:00:00
```

---

## 📊 모니터링

### 실시간 로그 확인

```bash
# 실시간 로그 모니터링
tail -f /Users/seongwookjang/project/git/violet_sw/005_money/logs/trading_20251003.log

# 거래 내역 확인
cat /Users/seongwookjang/project/git/violet_sw/005_money/logs/transactions.json

# 포지션 상태 확인
cat /Users/seongwookjang/project/git/violet_sw/005_money/logs/positions_v2.json
```

### GUI 모니터링 (선택)

```bash
cd /Users/seongwookjang/project/git/violet_sw/005_money
./gui -v ver2
```

**거래 현황 탭에서 확인:**
- 시장 체제 상태
- 진입 점수
- 현재 포지션
- 손익 현황

---

## 🛑 긴급 중단

### 방법 1: 긴급 정지 설정

**config_v2.py 수정:**
```python
SAFETY_CONFIG = {
    'emergency_stop': True,  # ← False에서 True로 변경
    # ...
}
```

**저장 후 재시작 또는 다음 체크 때 자동 중단**

### 방법 2: 프로세스 종료

```bash
# 실행 중인 프로세스 찾기
ps aux | grep main_v2

# 프로세스 종료
kill -9 <PID>
```

### 방법 3: 수동 청산

빗썸 웹사이트 또는 앱에서 직접 포지션 청산

---

## 📈 단계별 확대 전략

### 1주차: 최소 금액 테스트
```python
TRADING_CONFIG = {
    'trade_amount_krw': 10000,  # 10,000원
}
SAFETY_CONFIG = {
    'max_daily_trades': 1,      # 하루 1회
    'max_consecutive_losses': 2,
    'max_daily_loss_pct': 2.0,
}
```

### 2-3주차: 소폭 증가
```python
TRADING_CONFIG = {
    'trade_amount_krw': 20000,  # 20,000원
}
SAFETY_CONFIG = {
    'max_daily_trades': 2,      # 하루 2회
    'max_consecutive_losses': 2,
    'max_daily_loss_pct': 2.0,
}
```

### 4주차 이후: 점진적 확대
```python
TRADING_CONFIG = {
    'trade_amount_krw': 50000,  # 50,000원 (성과 좋을 시)
}
SAFETY_CONFIG = {
    'max_daily_trades': 3,      # 하루 3회
    'max_consecutive_losses': 3,
    'max_daily_loss_pct': 3.0,
}
```

**확대 조건:**
- ✅ 1주일 이상 안정적 운영
- ✅ 승률 50% 이상
- ✅ 최대 손실 낙폭 < 5%
- ✅ 버그나 오류 없음

---

## ⚠️ 주의사항

### 절대 하지 말아야 할 것

1. ❌ 백테스팅 없이 바로 실거래
2. ❌ 큰 금액으로 시작
3. ❌ 설정을 이해하지 못한 채 변경
4. ❌ API 키를 공개 저장소에 커밋
5. ❌ 로그 모니터링 없이 방치
6. ❌ 손실이 나도 무리하게 계속
7. ❌ 전략을 이해하지 못한 채 실행

### 반드시 해야 할 것

1. ✅ 매일 로그 확인
2. ✅ 주간 성과 분석
3. ✅ 예상치 못한 동작 시 즉시 중단
4. ✅ 손실 한도 엄격히 준수
5. ✅ API 키 보안 관리
6. ✅ 정기적 백업
7. ✅ 비상 연락 체계 유지

---

## 🔒 보안 권장사항

### API 키 관리

1. **환경 변수 사용** (최고 권장)
   ```bash
   export BITHUMB_API_KEY="..."
   export BITHUMB_SECRET_KEY="..."
   ```

2. **별도 설정 파일** (권장)
   ```bash
   # ~/.bithumb_keys (권한 600)
   API_KEY=...
   SECRET_KEY=...
   ```

3. **절대 하지 말 것**
   - Git에 커밋
   - 공개 공유
   - 스크린샷 캡처
   - 메신저로 전송

### 서버 보안

- 방화벽 설정
- SSH 키 인증
- 정기적 패스워드 변경
- 로그 백업

---

## 📊 성과 평가 지표

### 매일 확인

- 총 거래 횟수
- 승률
- 평균 수익/손실
- 최대 손실 낙폭

### 주간 확인

- 주간 수익률
- 샤프 지수
- 최대 연속 손실
- 전략 신뢰도

### 월간 확인

- 월간 수익률
- 목표 대비 달성률
- 리스크 대비 수익
- 전략 조정 필요성

---

## 🆘 문제 발생 시

### 즉시 중단 상황

1. **예상치 못한 큰 손실** (일일 한도 초과)
2. **API 오류 반복**
3. **포지션 추적 오류**
4. **로직 버그 발견**
5. **시장 급변** (플래시 크래시 등)

### 조치 방법

1. **긴급 정지:**
   ```python
   SAFETY_CONFIG['emergency_stop'] = True
   ```

2. **프로세스 종료:**
   ```bash
   pkill -f main_v2.py
   ```

3. **수동 청산:**
   - 빗썸 웹/앱에서 직접 처리

4. **로그 분석:**
   ```bash
   grep ERROR logs/trading_*.log
   ```

5. **원인 파악 및 수정**

6. **재테스트 후 재개**

---

## 📞 비상 연락

문제 발생 시:
1. 즉시 거래 중단
2. 로그 저장
3. 포지션 상태 확인
4. 전문가 상담

---

## ✅ 최종 체크리스트

실제 거래 시작 전 마지막 확인:

- [ ] 백테스팅 10개월 이상 완료
- [ ] Dry-run 1주일 이상 테스트
- [ ] `EXECUTION_CONFIG['dry_run']` = `False`
- [ ] `SAFETY_CONFIG['dry_run']` = `False`
- [ ] API 키 올바르게 설정
- [ ] 거래 금액 10,000원으로 시작
- [ ] 일일 거래 한도 1-2회
- [ ] 손실 한도 2% 설정
- [ ] 로그 모니터링 준비
- [ ] 긴급 중단 방법 숙지
- [ ] "I UNDERSTAND THE RISKS" 입력 준비

**모든 체크가 완료되었다면, 신중하게 시작하세요!**

---

**마지막 업데이트:** 2025-10-03
**중요:** 이 가이드는 교육 목적이며, 투자 권유가 아닙니다. 모든 투자 결정과 손실은 사용자 책임입니다.
