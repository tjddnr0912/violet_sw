# Score Monitoring Widget v2 - 사용 가이드

## 개요

**점수 모니터링** 탭은 v2 전략의 모든 점수 체크를 실시간으로 추적하는 새로운 기능입니다.

### 주요 차이점

| 탭 | 기록 대상 | 목적 | 기록 빈도 |
|----|----------|------|----------|
| **📈 점수 모니터링** | **모든 점수 (0-4점)** | 전략 분석, 점수 추세 파악 | 매 60초 |
| **📋 신호 히스토리** | **진입 신호만 (3-4점)** | 실제 거래 추적 | 진입 시에만 |

## 기능 설명

### 1. 통계 패널 (상단)

**1단: 전체 요약**
- **총 체크 횟수**: 점수를 체크한 총 횟수
- **평균 점수**: 평균 Entry Score (X.XX/4)
- **진입 가능 (3+)**: 3점 이상 발생 횟수와 비율

**2단: 점수 분포**
- 4/4, 3/4, 2/4, 1/4, 0/4 각 점수의 발생 횟수
- 색상 배지로 시각적 구분

**3단: 구성요소 발생 횟수**
- **BB**: BB Lower Touch 발생 횟수
- **RSI**: RSI Oversold 발생 횟수
- **Stoch**: Stochastic Cross 발생 횟수

### 2. 필터 기능

**표시 기간**
- 15M, 30M, 1H, 4H, 24H 선택
- 최근 X 시간 동안의 데이터만 표시

**최소 점수**
- 0, 1, 2, 3, 4 선택
- 선택한 점수 이상만 표시 (예: 3 선택 시 3-4점만)

**Regime**
- ALL, BULLISH, BEARISH, NEUTRAL
- 특정 시장 체제에서의 점수만 확인

### 3. 점수 체크 내역 (테이블)

**컬럼 설명:**
- **시간**: 체크 시간 (YYYY-MM-DD HH:MM)
- **총점**: 0/4 ~ 4/4 (색상 배경)
- **BB**: BB Lower Touch 점수 (+1 또는 -)
- **RSI**: RSI Oversold 점수 (+1 또는 -)
- **Stoch**: Stochastic Cross 점수 (+2 또는 -)
- **Regime**: 시장 체제 (BULLISH/BEARISH/NEUTRAL)
- **가격**: 체크 시점 BTC 가격
- **메모**: 상태 메시지
  - "✅ 진입 가능" (3-4점)
  - "⚠️ 1점 부족" (2점)
  - "대기" (0-1점)

**색상 코딩:**
- 4/4: 진한 녹색 배경
- 3/4: 연한 녹색 배경 + 굵은 글씨
- 2/4: 노란색 배경
- 1/4: 연한 빨강 배경
- 0/4: 빨강 배경

## 사용 방법

### 실시간 모니터링

1. GUI 실행:
   ```bash
   cd 005_money
   source .venv/bin/activate
   python 001_python_code/ver2/run_gui_v2.py
   ```

2. "🚀 봇 시작" 버튼 클릭

3. "📈 점수 모니터링" 탭으로 이동

4. **매 60초마다 자동으로 새 점수 체크 기록됨**

### 점수 추세 그래프 (NEW!)

**📊 점수 추세 그래프** 버튼을 클릭하면 시각화 창이 열립니다.

**그래프 기능:**
- **메인 그래프**: Entry Score 추세 라인 (0-4점)
  - 색상 구분: 점수에 따라 다른 색상 (4점=녹색, 0점=빨강)
  - 진입 가능 구간 음영 (3-4점 영역)
  - 기준선 표시 (진입 기준: 3점)
- **구성요소 분해 그래프** (옵션):
  - BB Touch, RSI Oversold, Stoch Cross 각 기여도
  - 스택 영역 차트로 시각화
- **통계 정보**:
  - 평균 점수, 최고/최저 점수
  - 진입 가능 비율 (%)
- **필터 연동**: 테이블 필터가 그래프에도 적용됨
- **확대/축소**: Matplotlib 도구바 (Zoom, Pan, Save)

**그래프 설정:**
- **"구성요소별 표시"** 체크박스: BB/RSI/Stoch 분해 그래프 표시
- 필터 변경 시 자동 업데이트
- "🔄 새로고침" 버튼으로 수동 업데이트

### 점수 추세 분석

**예시 1: 진입 기회 확인**
```
필터:
- 표시 기간: 4H (최근 4시간)
- 최소 점수: 3 (진입 가능 점수만)
- Regime: BULLISH

→ 최근 4시간 동안 강세장에서 진입 가능했던 시점 확인
→ "점수 추세 그래프" 클릭하여 시각적으로 추세 파악
```

**예시 2: 구성요소 분석**
```
필터:
- 표시 기간: 24H
- 최소 점수: 0 (전체)
- Regime: ALL

통계 확인:
- BB: 45회 발생
- RSI: 30회 발생
- Stoch: 12회 발생

→ BB Lower Touch가 가장 자주 발생함을 확인
```

### 데이터 내보내기

**CSV 내보내기:**
1. "💾 CSV 내보내기" 버튼 클릭
2. 저장 위치 선택
3. Excel/Google Sheets에서 분석

**CSV 형식:**
```csv
Timestamp,Score,BB Touch,RSI Oversold,Stoch Cross,Regime,Price,Entry Ready
2025-10-04 08:30:00,3,1,1,2,BULLISH,170000000,YES
2025-10-04 08:31:00,2,1,1,0,BULLISH,170050000,NO
```

## 전략 최적화 활용

### 1. 점수 임계값 검증

**질문**: "3점 임계값이 적절한가?"

**분석 방법:**
1. 24H 필터로 하루치 데이터 확인
2. 통계 확인:
   - 3-4점 발생: 8회 (5.5%)
   - 2점 발생: 25회 (17.2%)
   - 0-1점 발생: 112회 (77.2%)

**결론**:
- 3점 임계값 적절 (너무 느슨하면 잘못된 진입 증가)
- 만약 기회가 너무 적다면 2점으로 낮추는 것 고려

### 2. Regime 효과 분석

**질문**: "BULLISH regime에서 점수가 더 높은가?"

**분석 방법:**
1. BULLISH 필터 적용 → 평균 점수 확인
2. BEARISH 필터 적용 → 평균 점수 확인
3. 비교

**예시 결과:**
- BULLISH: 평균 1.8/4 (진입 가능 12%)
- BEARISH: 평균 0.9/4 (진입 가능 3%)

**결론**: Regime 필터가 효과적으로 작동 중

### 3. 시간대 분석

**질문**: "어느 시간대에 진입 기회가 많은가?"

**분석 방법:**
1. CSV 내보내기
2. Excel에서 시간대별 그룹화
3. 시간대별 평균 점수 계산

**활용**:
- 진입 기회가 많은 시간대 파악
- 봇 실행 시간 최적화

## 저장 및 복원

### 자동 저장

- 위치: `logs/score_checks_v2.json`
- 빈도: 매 점수 체크마다 자동 저장
- 용량: 최근 1440개 (24시간) 유지

### 세션 복원

- GUI 재시작 시 자동으로 이전 데이터 로드
- 24시간 이내 데이터는 모두 복원됨

## 주의사항

### 1. 데이터 용량

- **최대 1440개** 기록 유지 (24시간)
- 오래된 데이터는 자동 삭제됨
- 장기 분석 필요 시 CSV 내보내기 권장

### 2. 성능

- 점수 모니터링은 별도 탭이므로 다른 기능에 영향 없음
- 메모리 사용량: 약 1-2MB (1440개 기록 시)

### 3. 신호 히스토리와의 차이

```
점수 모니터링 (📈):
[08:00] 0/4 - - - BULLISH 170,000,000 대기
[08:01] 1/4 +1 - - BULLISH 170,050,000 대기
[08:02] 2/4 +1 +1 - BULLISH 170,100,000 ⚠️ 1점 부족
[08:03] 3/4 +1 +1 +2 BULLISH 170,150,000 ✅ 진입 가능  ← 모든 체크 기록

신호 히스토리 (📋):
[08:03] 3/4 BB(+1), RSI(+1), Stoch(+2) BULLISH BTC 170,150,000 ENTRY Pending  ← 3점 이상만
```

## FAQ

**Q: 왜 점수 모니터링이 필요한가요?**
A: 전략 최적화를 위해 모든 점수를 추적해야 합니다. 0-2점도 추세 파악에 중요한 정보입니다.

**Q: 신호 히스토리와 중복 아닌가요?**
A: 아닙니다. 신호 히스토리는 "실제 거래", 점수 모니터링은 "전략 분석"용입니다.

**Q: 점수 추세 그래프는 어떻게 사용하나요?**
A: "📊 점수 추세 그래프" 버튼을 클릭하면 시각화 창이 열립니다. 점수 추세 라인, 구성요소 분해, 통계 정보를 확인할 수 있습니다. 필터 설정에 따라 그래프도 자동 업데이트됩니다.

**Q: 1분마다 기록이 너무 많지 않나요?**
A: 24시간만 유지되므로 괜찮습니다. 필터를 사용하면 원하는 데이터만 볼 수 있습니다.

**Q: 그래프를 이미지로 저장할 수 있나요?**
A: 네! 그래프 창 하단의 Matplotlib 도구바에서 디스크 아이콘을 클릭하면 PNG/PDF 등으로 저장할 수 있습니다.

## 업데이트 내역

**v2.2 (2025-10-04 - Latest)**
- ✨ **점수 추세 그래프 기능 추가** (주요 업데이트!)
  - Entry Score 추세 라인 시각화 (0-4점)
  - 색상 구분 (점수별 다른 색상)
  - 진입 가능 구간 음영 표시
  - 구성요소 분해 그래프 (BB/RSI/Stoch 기여도)
  - 통계 정보 표시 (평균, 최고/최저, 진입 가능 비율)
  - 필터 연동 (테이블 필터 적용)
  - Zoom/Pan 기능, 이미지 저장 지원

**v2.1 (2025-10-04)**
- 점수 모니터링 탭 추가
- 모든 점수 체크 (0-4점) 실시간 추적
- 필터 기능 (시간대, 점수, Regime)
- CSV 내보내기 기능
- 자동 저장/복원 기능

---

**문의사항이나 개선 제안은 이슈로 남겨주세요!**
